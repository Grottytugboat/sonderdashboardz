<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SONDER // Projects</title>
<meta name="robots" content="noindex, nofollow">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%230a0a0a'/><text x='16' y='22' text-anchor='middle' fill='%239333ea' font-size='18' font-weight='bold' font-family='monospace'>S</text></svg>">
<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap');

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#060608;
  --bg-raised:#0a0a0e;
  --bg-card:#0e0e13;
  --bg-card-hover:#121218;
  --bg-input:#0a0a0e;
  --border:#1a1a22;
  --border-hover:#2a2a35;
  --text:#e4e4eb;
  --text-2:#78788a;
  --text-3:#48485a;
  --purple:#9333ea;
  --purple-dim:rgba(147,51,234,.15);
  --purple-glow:rgba(147,51,234,.08);
  --green:#22c55e;
  --green-dim:rgba(34,197,94,.15);
  --amber:#f59e0b;
  --amber-dim:rgba(245,158,11,.15);
  --red:#ef4444;
  --red-dim:rgba(239,68,68,.15);
  --blue:#3b82f6;
  --blue-dim:rgba(59,130,246,.15);
  --mono:'JetBrains Mono',monospace;
  --sans:'Outfit',sans-serif;
}
html{height:100%}
body{font-family:var(--sans);background:var(--bg);color:var(--text);height:100vh;overflow:hidden;-webkit-font-smoothing:antialiased}
body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:9999;opacity:.015;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")}
::selection{background:var(--purple);color:#fff}

#app{display:flex;height:100vh}

/* SIDEBAR */
.sidebar{width:240px;min-width:240px;background:var(--bg-raised);border-right:1px solid var(--border);display:flex;flex-direction:column}
.sidebar-brand{padding:20px 16px 16px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--border)}
.sidebar-brand .logo{font-family:var(--mono);font-size:10px;letter-spacing:3px;text-transform:uppercase;color:var(--text-2)}
.sidebar-brand .logo span{color:var(--purple)}
.search-box{padding:12px;border-bottom:1px solid var(--border)}
.search-box input{width:100%;padding:8px 10px;background:var(--bg-input);border:1px solid var(--border);color:var(--text);font-family:var(--mono);font-size:11px;outline:none;transition:border-color .2s}
.search-box input:focus{border-color:var(--purple)}
.search-box input::placeholder{color:var(--text-3)}
.sidebar-scroll{flex:1;overflow-y:auto;padding:8px 8px 16px;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.sidebar-section{margin-bottom:16px}
.sidebar-section-title{font-family:var(--mono);font-size:9px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text-3);padding:8px 8px 4px}
.sidebar-item{display:flex;align-items:center;justify-content:space-between;padding:6px 8px;cursor:pointer;font-size:12px;color:var(--text-2);transition:all .15s;font-weight:500}
.sidebar-item:hover{color:var(--text);background:rgba(255,255,255,.03)}
.sidebar-item.active{color:var(--purple);background:var(--purple-dim)}
.sidebar-item .dot{width:6px;height:6px;margin-right:8px;flex-shrink:0}
.sidebar-item .ico{font-family:var(--mono);font-size:10px;margin-right:8px;opacity:.5;width:14px;text-align:center}
.sidebar-item .count{font-family:var(--mono);font-size:10px;color:var(--text-3)}
.sidebar-footer{padding:10px 12px;border-top:1px solid var(--border);display:flex;gap:4px}
.sidebar-footer button{flex:1;padding:6px;background:none;border:1px solid var(--border);color:var(--text-3);font-family:var(--mono);font-size:10px;cursor:pointer;transition:all .15s;text-transform:uppercase;letter-spacing:1px}
.sidebar-footer button:hover{border-color:var(--border-hover);color:var(--text)}

/* MAIN */
.main{flex:1;display:flex;flex-direction:column;overflow:hidden}
.main-header{display:flex;align-items:center;justify-content:space-between;padding:20px 28px 16px;border-bottom:1px solid var(--border);flex-shrink:0}
.main-header h1{font-family:var(--mono);font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text-2)}
.main-header h1 span{color:var(--text)}
.header-actions{display:flex;gap:8px;align-items:center}
.sort-select{padding:6px 24px 6px 10px;background:var(--bg-card);border:1px solid var(--border);color:var(--text-2);font-family:var(--mono);font-size:10px;cursor:pointer;outline:none;letter-spacing:.5px;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='%2348485a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 6px center}
.btn-add{padding:6px 16px;background:var(--purple);color:#fff;border:none;font-family:var(--mono);font-size:10px;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.btn-add:hover{background:#7c22d0;box-shadow:0 0 16px var(--purple-glow)}

/* GRID */
.grid-wrap{flex:1;overflow-y:auto;padding:20px 28px 40px;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}

/* CARD */
.card{background:var(--bg-card);border:1px solid var(--border);cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--purple);transform:scaleX(0);transform-origin:left;transition:transform .3s ease}
.card:hover{border-color:var(--border-hover);transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,0,0,.4)}
.card:hover::before{transform:scaleX(1)}
.card.selected{border-color:var(--purple)}
.card-thumb{height:120px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
.card-thumb .initials{font-family:var(--mono);font-size:28px;font-weight:700;opacity:.15;letter-spacing:4px}
.card-thumb img{width:100%;height:100%;object-fit:cover;opacity:.8;transition:opacity .3s}
.card:hover .card-thumb img{opacity:1}
.card-status{position:absolute;top:8px;left:8px;display:flex;align-items:center;gap:4px;padding:2px 8px;font-family:var(--mono);font-size:9px;font-weight:600;letter-spacing:1px;text-transform:uppercase;background:rgba(6,6,8,.8);backdrop-filter:blur(8px);border:1px solid var(--border)}
.card-status .sdot{width:5px;height:5px;border-radius:50%}
.card-body{padding:12px 14px}
.card-name{font-size:14px;font-weight:600;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;letter-spacing:-.2px}
.card-meta{display:flex;justify-content:space-between;align-items:center}
.card-domain{font-family:var(--mono);font-size:10px;color:var(--text-3);letter-spacing:.3px}
.card-badge{font-family:var(--mono);font-size:8px;font-weight:700;padding:2px 6px;text-transform:uppercase;letter-spacing:.5px}

/* PANEL */
.panel-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:50;opacity:0;visibility:hidden;transition:all .2s}
.panel-overlay.open{opacity:1;visibility:visible}
.panel{position:fixed;top:0;right:0;width:420px;height:100vh;background:var(--bg-raised);border-left:1px solid var(--border);z-index:51;transform:translateX(100%);transition:transform .25s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column}
.panel.open{transform:translateX(0)}
.panel-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--border)}
.panel-header span{font-family:var(--mono);font-size:10px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text-2)}
.close-btn{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:none;border:1px solid var(--border);color:var(--text-3);cursor:pointer;font-size:14px;transition:all .15s;font-family:var(--mono)}
.close-btn:hover{border-color:var(--border-hover);color:var(--text)}
.panel-scroll{flex:1;overflow-y:auto;padding:16px 20px;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.field{margin-bottom:14px}
.field label{display:block;font-family:var(--mono);font-size:9px;font-weight:600;color:var(--text-3);margin-bottom:4px;text-transform:uppercase;letter-spacing:1.5px}
.field input,.field textarea,.field select{width:100%;padding:8px 10px;background:var(--bg-input);border:1px solid var(--border);color:var(--text);font-family:var(--mono);font-size:12px;outline:none;transition:border-color .2s}
.field input:focus,.field textarea:focus{border-color:var(--purple)}
.field input::placeholder,.field textarea::placeholder{color:var(--text-3)}
.field textarea{resize:vertical;min-height:64px}
.status-buttons,.category-buttons{display:flex;gap:4px;flex-wrap:wrap}
.status-btn,.category-btn{padding:5px 12px;border:1px solid var(--border);background:none;color:var(--text-2);font-family:var(--mono);font-size:10px;font-weight:500;cursor:pointer;transition:all .15s;letter-spacing:.5px;text-transform:uppercase}
.status-btn:hover,.category-btn:hover{border-color:var(--border-hover);color:var(--text)}
.status-btn.active,.category-btn.active{color:#fff;border-color:transparent}
.panel-actions{padding:12px 20px;border-top:1px solid var(--border);display:flex;gap:6px}
.panel-actions button{flex:1;padding:8px 14px;border:1px solid var(--border);font-family:var(--mono);font-size:10px;font-weight:600;cursor:pointer;transition:all .15s;text-transform:uppercase;letter-spacing:1px;background:none;color:var(--text-2)}
.btn-open{background:var(--purple)!important;color:#fff!important;border-color:var(--purple)!important}
.btn-open:hover{background:#7c22d0!important}
.btn-delete{color:var(--red)!important}
.btn-delete:hover{background:var(--red-dim);border-color:var(--red)!important}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:60;display:none;align-items:center;justify-content:center}
.modal-overlay.open{display:flex}
.modal{background:var(--bg-raised);border:1px solid var(--border);width:480px;max-height:80vh;display:flex;flex-direction:column}
.modal-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid var(--border)}
.modal-header h2{font-family:var(--mono);font-size:11px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--text)}
.modal-body{padding:16px 20px;overflow-y:auto;flex:1}
.modal-footer{padding:12px 20px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:8px}
.modal-footer button{padding:8px 20px;font-family:var(--mono);font-size:10px;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .15s;border:1px solid var(--border);background:none;color:var(--text-2)}
.modal-footer .btn-primary{background:var(--purple);color:#fff;border-color:var(--purple)}
.modal-footer .btn-primary:hover{background:#7c22d0}

/* EMPTY */
.empty-state{text-align:center;padding:80px 20px;color:var(--text-3)}
.empty-state h3{font-family:var(--mono);font-size:12px;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;color:var(--text-2)}
.empty-state p{font-size:13px;margin-bottom:24px}

/* TOAST */
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--bg-card);border:1px solid var(--border);padding:10px 20px;font-family:var(--mono);font-size:11px;color:var(--text);z-index:100;transition:transform .25s ease;letter-spacing:.5px}
.toast.show{transform:translateX(-50%) translateY(0)}

/* RESPONSIVE */
@media(max-width:768px){
  .sidebar{display:none}
  .grid{grid-template-columns:1fr}
  .panel{width:100%}
  .main-header{padding:16px}
  .grid-wrap{padding:12px}
}
</style>
</head>
<body>
<div id="app"></div>
<script>
const state = {
    sites: [],
    activeFilter: 'all',
    activeCategory: 'all',
    searchQuery: '',
    selectedSite: null,
    showModal: false,
    sortBy: 'updatedAt'
};

const genId = () => Date.now().toString(36) + Math.random().toString(36).slice(2, 8);

function gradient(name) {
    let h = 0;
    for (let i = 0; i < name.length; i++) h = name.charCodeAt(i) + ((h << 5) - h);
    const h1 = Math.abs(h) % 360, h2 = (h1 + 30) % 360;
    return `linear-gradient(135deg, hsl(${h1},30%,10%) 0%, hsl(${h2},40%,6%) 100%)`;
}

const initials = n => n.split(/[\s\-_]+/).slice(0, 2).map(w => w[0] || '').join('').toUpperCase();
function domainStr(url) { try { return new URL(url.startsWith('http') ? url : 'https://'+url).hostname.replace('www.',''); } catch { return url; } }
function timeAgo(d) {
    const s = Math.floor((Date.now() - new Date(d)) / 1000);
    for (const [l, v] of [['y',31536000],['mo',2592000],['w',604800],['d',86400],['h',3600],['m',60]]) { const c = Math.floor(s / v); if (c >= 1) return c + l + ' ago'; }
    return 'Now';
}

const sColor = s => ({live:'var(--green)',development:'var(--amber)',broken:'var(--red)',archived:'var(--text-3)',parked:'var(--blue)'}[s] || 'var(--text-3)');
const sLabel = s => ({live:'Live',development:'Building',broken:'Broken',archived:'Archived',parked:'Parked'}[s] || s);
const sBg = s => ({live:'var(--green-dim)',development:'var(--amber-dim)',broken:'var(--red-dim)',archived:'rgba(72,72,90,.15)',parked:'var(--blue-dim)'}[s] || 'rgba(72,72,90,.15)');
const cColor = c => ({client:'#3b82f6','side-project':'#a855f7',internal:'#9333ea',saas:'#22c55e',tool:'#f59e0b'}[c] || '#6b7280');
const cLabel = c => ({client:'Client','side-project':'Side Project',internal:'Internal',saas:'SaaS',tool:'Tool'}[c] || c);

function load() { try { const d = localStorage.getItem('sonder-dashboard-v2'); if (d) state.sites = JSON.parse(d); } catch {} }
function save() { localStorage.setItem('sonder-dashboard-v2', JSON.stringify(state.sites)); }

function filtered() {
    let s = [...state.sites];
    if (state.activeFilter !== 'all') s = s.filter(x => x.status === state.activeFilter);
    if (state.activeCategory !== 'all') s = s.filter(x => x.category === state.activeCategory);
    if (state.searchQuery) {
        const q = state.searchQuery.toLowerCase();
        s = s.filter(x => x.name.toLowerCase().includes(q) || x.url.toLowerCase().includes(q) || (x.client||'').toLowerCase().includes(q) || (x.description||'').toLowerCase().includes(q) || (x.techStack||'').toLowerCase().includes(q));
    }
    s.sort((a, b) => {
        if (state.sortBy === 'name') return a.name.localeCompare(b.name);
        if (state.sortBy === 'status') return a.status.localeCompare(b.status);
        return new Date(b.updatedAt) - new Date(a.updatedAt);
    });
    return s;
}

function statusCounts() {
    const c = {all:state.sites.length,live:0,development:0,broken:0,archived:0,parked:0};
    state.sites.forEach(s => { if (c[s.status] !== undefined) c[s.status]++; });
    return c;
}

function addSite(data) {
    const url = data.url.startsWith('http') ? data.url : 'https://'+data.url;
    state.sites.push({
        id: genId(), name: data.name, url, status: data.status||'development',
        category: data.category||'client', description: data.description||'',
        thumbnail: data.thumbnail||'', hosting: data.hosting||'',
        techStack: data.techStack||'', client: data.client||'', notes: data.notes||'',
        createdAt: new Date().toISOString(), updatedAt: new Date().toISOString()
    });
    save(); render(); toast('Project added');
}

function updateSite(id, data) {
    const i = state.sites.findIndex(s => s.id === id);
    if (i === -1) return;
    state.sites[i] = {...state.sites[i], ...data, updatedAt: new Date().toISOString()};
    state.selectedSite = state.sites[i];
    save(); render();
}

function deleteSite(id) {
    state.sites = state.sites.filter(s => s.id !== id);
    state.selectedSite = null;
    save(); render(); toast('Project removed');
}

function render() {
    const sites = filtered();
    const counts = statusCounts();
    const filterLabel = {all:'All Projects',live:'Live',development:'Building',broken:'Broken',archived:'Archived',parked:'Parked'}[state.activeFilter]||'All';
    const catLabel = state.activeCategory !== 'all' ? ` / ${cLabel(state.activeCategory)}` : '';

    document.getElementById('app').innerHTML = `
    <aside class="sidebar">
        <div class="sidebar-brand"><div class="logo">SONDER <span>//</span> PROJECTS</div></div>
        <div class="search-box"><input id="search-input" type="text" placeholder="Search projects..." value="${esc(state.searchQuery)}" oninput="doSearch(this.value)"></div>
        <div class="sidebar-scroll">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Status</div>
                ${[{k:'all',l:'All',ico:'◻'},{k:'live',l:'Live',dot:'var(--green)'},{k:'development',l:'Building',dot:'var(--amber)'},
                  {k:'parked',l:'Parked',dot:'var(--blue)'},{k:'broken',l:'Broken',dot:'var(--red)'},{k:'archived',l:'Archived',dot:'var(--text-3)'}
                ].map(x => `<div class="sidebar-item ${state.activeFilter===x.k?'active':''}" onclick="setFilter('${x.k}')">
                    <span style="display:flex;align-items:center">${x.dot?`<span class="dot" style="background:${x.dot}"></span>`:`<span class="ico">${x.ico}</span>`}${x.l}</span>
                    <span class="count">${counts[x.k]||0}</span>
                </div>`).join('')}
            </div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Type</div>
                ${[{k:'all',l:'All',ico:'◻'},{k:'client',l:'Client',ico:'◆'},{k:'saas',l:'SaaS',ico:'◈'},
                  {k:'side-project',l:'Side Project',ico:'◇'},{k:'internal',l:'Internal',ico:'◉'},{k:'tool',l:'Tool',ico:'◎'}
                ].map(x => `<div class="sidebar-item ${state.activeCategory===x.k?'active':''}" onclick="setCat('${x.k}')">
                    <span style="display:flex;align-items:center"><span class="ico">${x.ico}</span>${x.l}</span>
                </div>`).join('')}
            </div>
        </div>
        <div class="sidebar-footer">
            <button onclick="exportJSON()">Export</button>
            <button onclick="document.getElementById('imp').click()">Import</button>
            <input type="file" id="imp" accept=".json" style="display:none" onchange="importJSON(event)">
        </div>
    </aside>
    <main class="main">
        <div class="main-header">
            <h1>${filterLabel}${catLabel} <span>[${sites.length}]</span></h1>
            <div class="header-actions">
                <select class="sort-select" onchange="state.sortBy=this.value;render()">
                    <option value="updatedAt" ${state.sortBy==='updatedAt'?'selected':''}>Recent</option>
                    <option value="name" ${state.sortBy==='name'?'selected':''}>Name</option>
                    <option value="status" ${state.sortBy==='status'?'selected':''}>Status</option>
                </select>
                <button class="btn-add" onclick="openModal()">+ New</button>
            </div>
        </div>
        <div class="grid-wrap">
            ${sites.length ? `<div class="grid">${sites.map(cardHTML).join('')}</div>` : emptyHTML()}
        </div>
    </main>
    <div class="panel-overlay ${state.selectedSite?'open':''}" onclick="closePanel()"></div>
    <div class="panel ${state.selectedSite?'open':''}">${state.selectedSite ? panelHTML(state.selectedSite) : ''}</div>
    <div class="modal-overlay ${state.showModal?'open':''}" onclick="closeModal()">
        <div class="modal" onclick="event.stopPropagation()">${modalHTML()}</div>
    </div>
    <div class="toast" id="toast-el"></div>`;
}

function cardHTML(s) {
    const thumb = s.thumbnail
        ? `<img src="${esc(s.thumbnail)}" alt="" onerror="this.outerHTML='<span class=\\'initials\\'>${initials(s.name)}</span>'">`
        : `<span class="initials">${initials(s.name)}</span>`;
    return `<div class="card ${state.selectedSite?.id===s.id?'selected':''}" onclick="selectSite('${s.id}')" ondblclick="window.open('${esc(s.url)}','_blank')">
        <div class="card-thumb" style="background:${gradient(s.name)}">
            ${thumb}
            <div class="card-status"><span class="sdot" style="background:${sColor(s.status)}"></span>${sLabel(s.status)}</div>
        </div>
        <div class="card-body">
            <div class="card-name">${esc(s.name)}</div>
            <div class="card-meta">
                <span class="card-domain">${domainStr(s.url)}</span>
                <span class="card-badge" style="background:${cColor(s.category)}18;color:${cColor(s.category)}">${cLabel(s.category)}</span>
            </div>
        </div>
    </div>`;
}

function panelHTML(s) {
    const statuses = ['live','development','parked','broken','archived'];
    const cats = ['client','saas','side-project','internal','tool'];
    return `<div class="panel-header"><span>Project Settings</span><button class="close-btn" onclick="closePanel()">✕</button></div>
    <div class="panel-scroll">
        <div class="field"><label>Name</label><input value="${esc(s.name)}" onchange="up('${s.id}','name',this.value)"></div>
        <div class="field"><label>URL</label><input value="${esc(s.url)}" onchange="up('${s.id}','url',this.value)"></div>
        <div class="field"><label>Status</label><div class="status-buttons">
            ${statuses.map(x=>`<button class="status-btn ${s.status===x?'active':''}" style="${s.status===x?`background:${sColor(x)};border-color:${sColor(x)}`:''}" onclick="up('${s.id}','status','${x}')">${sLabel(x)}</button>`).join('')}
        </div></div>
        <div class="field"><label>Type</label><div class="category-buttons">
            ${cats.map(x=>`<button class="category-btn ${s.category===x?'active':''}" style="${s.category===x?`background:${cColor(x)};border-color:${cColor(x)}`:''}" onclick="up('${s.id}','category','${x}')">${cLabel(x)}</button>`).join('')}
        </div></div>
        <div class="field"><label>Description</label><textarea placeholder="What is this?" onchange="up('${s.id}','description',this.value)">${esc(s.description||'')}</textarea></div>
        <div class="field"><label>Client</label><input value="${esc(s.client||'')}" placeholder="Client name" onchange="up('${s.id}','client',this.value)"></div>
        <div class="field"><label>Hosting</label><input value="${esc(s.hosting||'')}" placeholder="Vercel, etc." onchange="up('${s.id}','hosting',this.value)"></div>
        <div class="field"><label>Tech Stack</label><input value="${esc(s.techStack||'')}" placeholder="Next.js, HTML, etc." onchange="up('${s.id}','techStack',this.value)"></div>
        <div class="field"><label>Thumbnail</label><input value="${esc(s.thumbnail||'')}" placeholder="Screenshot URL" onchange="up('${s.id}','thumbnail',this.value)"></div>
        <div class="field"><label>Notes</label><textarea placeholder="Notes..." onchange="up('${s.id}','notes',this.value)">${esc(s.notes||'')}</textarea></div>
        <div style="font-family:var(--mono);font-size:10px;color:var(--text-3);margin-top:8px;letter-spacing:.5px">Created ${timeAgo(s.createdAt)} · Updated ${timeAgo(s.updatedAt)}</div>
    </div>
    <div class="panel-actions">
        <button class="btn-open" onclick="window.open('${esc(s.url)}','_blank')">Open ↗</button>
        <button class="btn-delete" onclick="confirmDel('${s.id}')">Delete</button>
    </div>`;
}

function modalHTML() {
    return `<div class="modal-header"><h2>New Project</h2><button class="close-btn" onclick="closeModal()">✕</button></div>
    <div class="modal-body">
        <div class="field"><label>Name *</label><input id="m-name" placeholder="Project name"></div>
        <div class="field"><label>URL *</label><input id="m-url" placeholder="https://example.com"></div>
        <div class="field"><label>Status</label><select id="m-status">
            <option value="live">Live</option><option value="development" selected>Building</option>
            <option value="parked">Parked</option><option value="broken">Broken</option><option value="archived">Archived</option>
        </select></div>
        <div class="field"><label>Type</label><select id="m-cat">
            <option value="client">Client</option><option value="saas">SaaS</option>
            <option value="side-project">Side Project</option><option value="internal">Internal</option><option value="tool">Tool</option>
        </select></div>
        <div class="field"><label>Client</label><input id="m-client" placeholder="Optional"></div>
        <div class="field"><label>Hosting</label><input id="m-hosting" placeholder="Vercel"></div>
        <div class="field"><label>Tech Stack</label><input id="m-tech" placeholder="HTML, Next.js, etc."></div>
    </div>
    <div class="modal-footer">
        <button onclick="closeModal()">Cancel</button>
        <button class="btn-primary" onclick="submitModal()">Add Project</button>
    </div>`;
}

function emptyHTML() {
    if (state.searchQuery) return `<div class="empty-state"><h3>No results</h3><p>Nothing matches "${esc(state.searchQuery)}"</p></div>`;
    return `<div class="empty-state"><h3>No projects</h3><p>Add your first project</p><button class="btn-add" onclick="openModal()">+ New Project</button></div>`;
}

function esc(s) { const d = document.createElement('div'); d.textContent = s||''; return d.innerHTML; }

function doSearch(v) { state.searchQuery = v; render(); const el = document.getElementById('search-input'); if (el) { el.focus(); el.setSelectionRange(v.length, v.length); } }
function setFilter(f) { state.activeFilter = f; render(); }
function setCat(c) { state.activeCategory = c; render(); }
function selectSite(id) { state.selectedSite = state.sites.find(s => s.id === id)||null; render(); }
function closePanel() { state.selectedSite = null; render(); }
function openModal() { state.showModal = true; render(); setTimeout(() => document.getElementById('m-name')?.focus(), 80); }
function closeModal() { state.showModal = false; render(); }
function up(id, field, val) { updateSite(id, {[field]: val}); }
function confirmDel(id) { if (confirm('Delete this project?')) deleteSite(id); }

function submitModal() {
    const name = document.getElementById('m-name')?.value?.trim();
    const url = document.getElementById('m-url')?.value?.trim();
    if (!name || !url) { toast('Name and URL required'); return; }
    addSite({
        name, url, status: document.getElementById('m-status')?.value,
        category: document.getElementById('m-cat')?.value,
        client: document.getElementById('m-client')?.value?.trim(),
        hosting: document.getElementById('m-hosting')?.value?.trim(),
        techStack: document.getElementById('m-tech')?.value?.trim()
    });
    closeModal();
}

function toast(msg) {
    setTimeout(() => { const el = document.getElementById('toast-el'); if (el) { el.textContent = msg; el.classList.add('show'); setTimeout(() => el.classList.remove('show'), 2200); } }, 60);
}

function exportJSON() {
    const b = new Blob([JSON.stringify(state.sites, null, 2)], {type:'application/json'});
    const a = document.createElement('a'); a.href = URL.createObjectURL(b);
    a.download = `sonder-projects-${new Date().toISOString().slice(0,10)}.json`;
    a.click(); URL.revokeObjectURL(a.href); toast('Exported');
}

function importJSON(e) {
    const f = e.target.files[0]; if (!f) return;
    const r = new FileReader();
    r.onload = ev => { try { const d = JSON.parse(ev.target.result); if (Array.isArray(d)) { state.sites = d; save(); render(); toast(`Imported ${d.length} projects`); } } catch { toast('Invalid file'); } };
    r.readAsText(f); e.target.value = '';
}

document.addEventListener('keydown', e => {
    if (e.key === 'k' && (e.metaKey || e.ctrlKey)) { e.preventDefault(); document.getElementById('search-input')?.focus(); }
    if (e.key === 'Escape') { if (state.showModal) closeModal(); else if (state.selectedSite) closePanel(); }
    const tag = document.activeElement?.tagName;
    if (e.key === 'n' && !state.showModal && !state.selectedSite && tag !== 'INPUT' && tag !== 'TEXTAREA' && tag !== 'SELECT') openModal();
});

load();

if (!state.sites.length) {
    const ago = d => new Date(Date.now() - d*86400000).toISOString();
    state.sites = [
        // LIVE PROJECTS
        {id:genId(),name:'Sonder Sites',url:'https://www.sondersites.com',status:'live',category:'internal',description:'Main agency website. Enterprise Shopify + web dev positioning.',thumbnail:'',hosting:'Vercel',techStack:'HTML, CSS, JS',client:'',notes:'Vercel project: sondersites. Custom domain configured.',createdAt:ago(180),updatedAt:ago(1)},
        {id:genId(),name:'Gather',url:'https://www.usegather.com.au',status:'live',category:'saas',description:'Lightspeed to Klaviyo integration for ecommerce agencies. 9 paying customers, $851 MRR.',thumbnail:'',hosting:'Vercel',techStack:'Node.js, Express, EJS',client:'',notes:'Repo: Grottytugboat/newgather2. Target: $10k MRR.',createdAt:ago(120),updatedAt:ago(1)},
        {id:genId(),name:'Kyneton Party Hire',url:'https://kynetonpartyhire.com',status:'live',category:'side-project',description:'Local party hire business. Bookings, inventory, customers.',thumbnail:'',hosting:'Vercel',techStack:'HTML, JS',client:'',notes:'Side income. Automate, minimal time.',createdAt:ago(200),updatedAt:ago(7)},
        {id:genId(),name:'Little Legends',url:'https://www.littlelegendsmelbourne.com.au',status:'live',category:'side-project',description:'Character entertainment hire for kids parties. 26 character pages, SEO-driven.',thumbnail:'',hosting:'Vercel',techStack:'HTML, CSS',client:'',notes:'26 characters, 13 suburb pages, 5 blog posts.',createdAt:ago(30),updatedAt:ago(1)},
        {id:genId(),name:'Sana Swart',url:'https://sana-swart.vercel.app',status:'live',category:'client',description:'Portfolio site for Sana Swart.',thumbnail:'',hosting:'Vercel',techStack:'Node.js, Express',client:'Sana Swart',notes:'Vercel project: sana.',createdAt:ago(60),updatedAt:ago(3)},
        {id:genId(),name:'JJ\'s Garden',url:'https://jjs-garden.vercel.app',status:'live',category:'client',description:'Garden services website.',thumbnail:'',hosting:'Vercel',techStack:'HTML',client:'JJ\'s Garden',notes:'',createdAt:ago(90),updatedAt:ago(14)},
        {id:genId(),name:'University Outreach',url:'https://unioutreach.vercel.app',status:'live',category:'internal',description:'University sales landing page. Case study from RMIT deployment. $715k pipeline potential.',thumbnail:'',hosting:'Vercel',techStack:'HTML, CSS',client:'',notes:'DNS: university.sondersites.com needs A record deleted in GoDaddy. Content works at Vercel URL.',createdAt:ago(20),updatedAt:ago(1)},
        {id:genId(),name:'Follow',url:'https://follow-site.vercel.app',status:'development',category:'saas',description:'Independent data layer for Shopify merchants. Own your store\'s memory. Early access landing page live.',thumbnail:'',hosting:'Vercel',techStack:'HTML, CSS, JS, Serverless',client:'',notes:'Repo: Grottytugboat/follow-site. Email signup via Resend.',createdAt:ago(1),updatedAt:ago(0)},

        // ACTIVE TOOLS
        {id:genId(),name:'Sonder HQ',url:'https://sonder-hq-nine.vercel.app',status:'live',category:'tool',description:'Password-protected business dashboard. ClickUp priority, calendar, insights, stats.',thumbnail:'',hosting:'Vercel',techStack:'HTML, JS, Serverless',client:'',notes:'Password: sonder. Domain: hq.sondersites.com (SSL pending).',createdAt:ago(1),updatedAt:ago(0)},
        {id:genId(),name:'Sonder Dashboard',url:'https://sonderdashboardz.vercel.app',status:'live',category:'tool',description:'Project portfolio tracker. All Sonder Sites projects in one place.',thumbnail:'',hosting:'Vercel',techStack:'HTML, JS',client:'',notes:'LocalStorage-based. Export/import JSON.',createdAt:ago(1),updatedAt:ago(0)},
        {id:genId(),name:'The Sonder Score',url:'https://www.sondersites.com/tools/rate-my-store',status:'live',category:'tool',description:'AI-powered Shopify store audit tool. Lead gen for Sonder Sites.',thumbnail:'',hosting:'Vercel',techStack:'HTML, JS, Claude API',client:'',notes:'Branded audit tool. Generates leads via email capture.',createdAt:ago(14),updatedAt:ago(1)},

        // HUGE
        {id:genId(),name:'HUGE',url:'https://huge.app',status:'development',category:'saas',description:'Identity expansion and creative leverage app. TOP PRIORITY. Built with Ying, marketed by Matt (Scale).',thumbnail:'',hosting:'App Store',techStack:'Swift, iOS',client:'',notes:'Has paying customers. Needs Stripe connected. Superwall paywall. Fix onboarding.',createdAt:ago(90),updatedAt:ago(3)},

        // PARKED / ARCHIVED
        {id:genId(),name:'SonderClaw',url:'https://sonderclaw.com',status:'parked',category:'saas',description:'AI-powered client portal for tradies and SMBs. Set-and-forget SaaS.',thumbnail:'',hosting:'Vercel',techStack:'Next.js',client:'',notes:'Parked until HUGE and Gather hit targets.',createdAt:ago(150),updatedAt:ago(30)},
        {id:genId(),name:'Elder Emo',url:'https://elderemo.vercel.app',status:'archived',category:'side-project',description:'Elder emo culture site.',thumbnail:'',hosting:'Vercel',techStack:'HTML',client:'',notes:'',createdAt:ago(100),updatedAt:ago(60)},
        {id:genId(),name:'Spotter',url:'https://jofrey.sondersites.com/spotter/',status:'parked',category:'tool',description:'PWA: snap a business, get a website built. Walk around, spot businesses with bad websites.',thumbnail:'',hosting:'PM2 local',techStack:'Node.js, PWA',client:'',notes:'Sends to Discord #spotter channel. Parked.',createdAt:ago(20),updatedAt:ago(14)},
        {id:genId(),name:'Focus Timer',url:'https://jofrey.sondersites.com/focus-timer/',status:'parked',category:'tool',description:'Task-based focus timer. Llama Life clone.',thumbnail:'',hosting:'PM2 local',techStack:'HTML, JS',client:'',notes:'Port 3900 on server.',createdAt:ago(14),updatedAt:ago(14)},
    ];
    save();
}

render();
</script>
</body>
</html>
